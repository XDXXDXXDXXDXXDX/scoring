<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>DOM 优化 | 快应用性能优化实践</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="通过学习文档中快应用的优化方法，让您快速提升您得快应用性能">
    
    <link rel="preload" href="/assets/css/0.styles.5a097fab.css" as="style"><link rel="preload" href="/assets/js/app.56d6d8fb.js" as="script"><link rel="preload" href="/assets/js/2.3be33aa9.js" as="script"><link rel="preload" href="/assets/js/12.0ce8276c.js" as="script"><link rel="prefetch" href="/assets/js/10.24381f1f.js"><link rel="prefetch" href="/assets/js/11.0ddd98b9.js"><link rel="prefetch" href="/assets/js/13.3ef61db5.js"><link rel="prefetch" href="/assets/js/3.fd98c83e.js"><link rel="prefetch" href="/assets/js/4.e7fc07bd.js"><link rel="prefetch" href="/assets/js/5.0ad9cff4.js"><link rel="prefetch" href="/assets/js/6.842bf86e.js"><link rel="prefetch" href="/assets/js/7.79aa0846.js"><link rel="prefetch" href="/assets/js/8.18229252.js"><link rel="prefetch" href="/assets/js/9.76817e02.js">
    <link rel="stylesheet" href="/assets/css/0.styles.5a097fab.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">快应用性能优化实践</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>开始</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>运行时优化</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/runtime-js.html" class="sidebar-link">脚本执行时间</a></li><li><a href="/guide/runtime-dom.html" aria-current="page" class="active sidebar-link">DOM 优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/runtime-dom.html#list-组件懒加载" class="sidebar-link">list 组件懒加载</a></li><li class="sidebar-sub-header"><a href="/guide/runtime-dom.html#swiper-组件懒加载" class="sidebar-link">swiper 组件懒加载</a></li><li class="sidebar-sub-header"><a href="/guide/runtime-dom.html#tabs-组件懒加载" class="sidebar-link">tabs 组件懒加载</a></li><li class="sidebar-sub-header"><a href="/guide/runtime-dom.html#其它优化" class="sidebar-link">其它优化</a></li></ul></li><li><a href="/guide/runtime-network.html" class="sidebar-link">网络耗时优化</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>rpk包大小优化</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="dom-优化"><a href="#dom-优化" class="header-anchor">#</a> DOM 优化</h1> <p>当首次渲染的 DOM 节点树太多和节点数的深度太深时会延长渲染的时间，可采用懒加载的方式在首屏渲染的时候不加载页面的所有资源，当资源即将呈现在手机可视区域时再加载相关的资源。</p> <h2 id="list-组件懒加载"><a href="#list-组件懒加载" class="header-anchor">#</a> list 组件懒加载</h2> <p>在首页我们常常会用到 list 组件来渲染列表，但如果从服务端一次性请求列表的所有数据并渲染完所有的数据会造成首屏加载的时间过长，因此可采用懒加载的方式优化列表的渲染，可参考官网的<a href="https://doc.quickapp.cn/tutorial/widgets/list-tutorial.html#list-item-%E6%87%92%E5%8A%A0%E8%BD%BD" target="_blank" rel="noopener noreferrer">list 组件的懒加载教程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>实现思路：</p> <p>1.渲染首屏时，将请求的数据保存在<code>shopList</code>中，并从<code>shopList</code>提取部分数据到<code>filterShopList</code>用于首屏的列表渲染；</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">onInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 初始化的时候从源数据数组中选择size长度的数据进行列表渲染</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>filteredShopList <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>shopList<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>size<span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>shopList <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>shopList<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>size<span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$watch</span><span class="token punctuation">(</span><span class="token string">'filter'</span><span class="token punctuation">,</span> <span class="token string">'watchFilterChange'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>2.通过监听列表的<code>scrollbottom</code>事件，当列表滚动到底部时触发<code>renderMoreListItem</code>回调事件；</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- 列表实现，监听列表的scrollbottom事件，列表滚动到底部时加载更多数据 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>list</span> <span class="token attr-name">onscrollbottom</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>renderMoreListItem<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>shop-list-container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>list</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>3.<code>renderMoreListItem</code>回调事件<code>renderList</code>中判断<code>shopList</code>是否有足够的数据进行列表的渲染，有则显示‘加载更多’的组件并把一部分数据加入到<code>filterShopList</code>进行列表的渲染，没有则进行数据的请求或者显示‘已经到底了’的组件对用户进行提示。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">renderMoreListItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">renderList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token function">renderList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 当缓存数组中的长度大于0时，加载数据</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>shopList<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>hasMoreData <span class="token operator">=</span> <span class="token boolean">true</span>
      <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>shopList<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>size<span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>filteredShopList <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>filteredShopList<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>shopList <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>shopList<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>size<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// 否则显示已经加载完</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>hasMoreData <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="swiper-组件懒加载"><a href="#swiper-组件懒加载" class="header-anchor">#</a> swiper 组件懒加载</h2> <p>在首页会经常出现 swiper 轮播图，如果首次渲染的时候一次性请求轮播所有子组件所需的数据会增加请求的耗时和增加首次 DOM 渲染的数量，因此可以通过 swiper 的 onChange 回调事件再进行子组件的数据请求和渲染，便可以减少首屏渲染所需的时间。</p> <ol><li>首先在 swiper 组件上的绑定<code>onchange</code>的回调事件<code>loadMoreCategory</code>，并使 <code>id</code>为<code>foodCategory2</code>的组件的数据源为空数组</li></ol> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>shopList</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>shopList<span class="token punctuation">&quot;</span></span> <span class="token attr-name">filter</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{filter}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>custom-page<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 通过swiper的onchang回调事件加载更多的catefory --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>swiper</span>
        <span class="token attr-name">show</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{!isSearching}}<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>swiperContent<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">onchange</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>loadMoreCategory<span class="token punctuation">&quot;</span></span>
      <span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>foodCategory</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>foodCategory<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{foodCategory}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>foodCategory</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>foodCategory</span>
          <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>foodCategory2<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">data</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{foodCategory2}}<span class="token punctuation">&quot;</span></span>
        <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>foodCategory</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>swiper</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>shopList</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ol start="2"><li>当页面切换时，触发<code>loadMoreCategory</code>函数再进行数据的请求或者赋值，即可实现<code>swiper</code>组件的懒加载模式</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">loadMoreCategory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 切换页面的时候再加载Category</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>foodCategory2 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>foodCategory<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>foodCategory2<span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="tabs-组件懒加载"><a href="#tabs-组件懒加载" class="header-anchor">#</a> tabs 组件懒加载</h2> <p>在首页一般会用<code>tabs</code>组件进行页面的切换，原 demo 使用的是 Apex 的<code>tabs</code>组件，使用切换路由的方式来实现页面的切换过程，因此在切换页面的时候有些卡顿，会给用户造成不好的使用体验。在优化过程中使用快应用原生的 <code>tabs</code> 组件将页面进行重写，在此之前请首先参考<a href="https://doc.quickapp.cn/widgets/tabs.html" target="_blank" rel="noopener noreferrer">tabs 的介绍页面<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>和<a href="https://github.com/quickappcn/sample/blob/master/src/component/container/tabs/index.ux" target="_blank" rel="noopener noreferrer">github 的具体示例<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p><code>tabs</code>的子组件主要有<code>tab-bar</code>和<code>tab-content</code>组件，<code>tab-content</code>中 div 组件的排序对应<code>tab-bar</code>中 div 组件的排序，详细可参考如下的代码的注释。</p> <div class="custom-block tip"><p class="custom-block-title">注意</p> <p>当<code>tab-bar</code>组件在<code>tab-content</code>下方排列时（如下），那么<code>tab-bar</code>则在页面底部显示；若<code>tab-bar</code>组件在<code>tab-content</code>上方排列，<code>tab-bar</code>则在页面上方排列。</p></div> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 选用原生tabs组件 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tabs</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tabs<span class="token punctuation">&quot;</span></span> <span class="token attr-name">index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 页面内容 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tab-content</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tabs-content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 外卖页面 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 我的页面 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tab-content</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 导航栏 （显示在页面底部） --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tab-bar</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tab-bar<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 点击此div对应外卖页面 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 点击此div对应我的页面 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tab-bar</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tabs</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><code>tab-content</code>一般包含好几个页面的内容，在首屏渲染时无需全部加载，可通过<code>tabs</code>组件在页面切换时触发<code>onchange</code>的回调事件再进行页面的渲染。</p> <ol><li>首先在 tabs 组件上的绑定<code>onchange</code>的回调事件<code>changeTabactive</code>，并使 <code>showMine</code>的值为<code>false</code>触发条件渲染指令使得<code>我的页面</code>在首屏时不渲染</li></ol> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 绑定onchange的回调事件changeTabactive --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tabs</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tabs<span class="token punctuation">&quot;</span></span> <span class="token attr-name">index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onchange</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>changeTabactive<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tab-content</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tabs-content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 首屏渲染时仅加载外卖页面 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 首屏渲染时不加载我的页面 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{ showMine }}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>minePage</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>minePage</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tab-content</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tabs</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ol start="2"><li>当页面切换时，触发<code>changeTabactive</code>，更改<code>showMine</code>的值为<code>true</code>从而渲染<code>我的页面</code>,便可以实现<code>tabs</code>组件的懒加载模式，并有十分顺滑的切换体验。</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">changeTabactive</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>showMine <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="其它优化"><a href="#其它优化" class="header-anchor">#</a> 其它优化</h2> <p>编写代码时我们常常会用 div 组件包裹某些组件，但有些不必要的节点是可以删除的，这样可以减少节点的渲染。另外有些组件是可以合并为一个组件的，如下为原 demo 的“加载更多”和“没有更多了”的代码，</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>list-item</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>lordmore<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>load-more<span class="token punctuation">&quot;</span></span> <span class="token attr-name">if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{hasMoreData}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-load-more</span> <span class="token attr-name">tip</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>加载更多<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-load-more</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>list-item</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>list-item</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>nomore<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>load-more<span class="token punctuation">&quot;</span></span> <span class="token attr-name">if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{!hasMoreData}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-load-more</span> <span class="token attr-name">tip</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>没有更多了<span class="token punctuation">&quot;</span></span> <span class="token attr-name">loading</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{ false }}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-load-more</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>list-item</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>其实可以通过一个变量<code>hasMoreDate</code>来进行条件渲染，从而可以减少 DOM 的节点数</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- 优化dom结构 减少DOM节点--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>list-item</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>loadMore<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>load-more<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-load-more</span>
    <span class="token attr-name">tip</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{ hasMoreData ? <span class="token punctuation">'</span>加载更多<span class="token punctuation">'</span> : <span class="token punctuation">'</span>已经到底了<span class="token punctuation">'</span>}}<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">loading</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{ hasMoreData }}<span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-load-more</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>list-item</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/guide/runtime-js.html" class="prev">
        脚本执行时间
      </a></span> <span class="next"><a href="/guide/runtime-network.html">
        网络耗时优化
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.56d6d8fb.js" defer></script><script src="/assets/js/2.3be33aa9.js" defer></script><script src="/assets/js/12.0ce8276c.js" defer></script>
  </body>
</html>
